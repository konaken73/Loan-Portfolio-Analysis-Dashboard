
================================================================================
Date: 2026-02-06 11:30:29.505190
Fichier: sql/queries/kpi_overview.sql
Erreur: Erreur SQL: 1st ORDER BY term does not match any column in the result set
Requête: -- =============================================================================
-- REQUÊTES SQL POUR LES KPIs DE VUE D'ENSEMBLE
-- ====================================================================... (tronquée)
================================================================================

================================================================================
Date: 2026-02-06 11:30:31.889084
Fichier: sql/queries/kpi_overview.sql
Erreur: Erreur SQL: no such column: issue_year
Requête: -- 6. ÉVOLUTION TEMPORELLE DES DÉCAISSEMENTS
SELECT 
    issue_year as annee,
    issue_month as mois,
    issue_year || '-' || PRINTF('%02d', issue_month) as periode,
    COUNT(*) as prets_emis,
    ... (tronquée)
================================================================================

================================================================================
Date: 2026-02-06 11:30:31.889314
Fichier: sql/queries/kpi_overview.sql
Erreur: Erreur SQL: no such column: issue_year
Requête: -- 7. PERFORMANCE PAR ANNÉE
SELECT 
    issue_year as annee,
    COUNT(*) as total_prets,
    ROUND(SUM(loan_amnt), 0) as montant_total,
    ROUND(AVG(int_rate), 2) as taux_interet_moyen,
    SUM(CASE... (tronquée)
================================================================================

================================================================================
Date: 2026-02-06 11:30:32.315983
Fichier: sql/queries/kpi_overview.sql
Erreur: Erreur SQL: no such column: issue_season
Requête: -- 9. RÉCAPITULATIF PAR SAISON
SELECT 
    issue_season as saison,
    COUNT(*) as nombre_prets,
    ROUND(COUNT(*) * 100.0 / (SELECT COUNT(*) FROM loans), 2) as pourcentage_total,
    ROUND(SUM(loan_... (tronquée)
================================================================================

================================================================================
Date: 2026-02-06 11:30:33.176694
Fichier: sql/queries/performance.sql
Erreur: Erreur SQL: no such column: total_rec_prncp
Requête: -- =============================================================================
-- ANALYSE DE PERFORMANCE ET RECOUVREMENT
-- ==========================================================================... (tronquée)
================================================================================

================================================================================
Date: 2026-02-06 11:30:33.176958
Fichier: sql/queries/performance.sql
Erreur: Erreur SQL: no such column: total_rec_int
Requête: -- 2. PERFORMANCE PAR GRADE - ANALYSE DE RENTABILITÉ
SELECT 
    grade,
    COUNT(*) as nombre_prets,
    ROUND(SUM(loan_amnt), 0) as montant_total,
    ROUND(SUM(total_pymnt), 0) as paiements_recus,
... (tronquée)
================================================================================

================================================================================
Date: 2026-02-06 11:30:33.177185
Fichier: sql/queries/performance.sql
Erreur: Erreur SQL: no such column: issue_year
Requête: -- 3. ÉVOLUTION TEMPORELLE DES PERFORMANCES
SELECT 
    issue_year as annee,
    issue_quarter as trimestre,
    issue_year || 'T' || issue_quarter as periode,
    COUNT(*) as prets_emis,
    ROUND(SU... (tronquée)
================================================================================

================================================================================
Date: 2026-02-06 11:30:33.177394
Fichier: sql/queries/performance.sql
Erreur: Erreur SQL: no such column: out_prncp
Requête: -- 4. ANALYSE DES PAIEMENTS EN RETARD
SELECT 
    CASE 
        WHEN loan_status LIKE 'LATE%' THEN 'En retard'
        WHEN loan_status = 'IN GRACE PERIOD' THEN 'Période de grâce'
        ELSE 'À jour... (tronquée)
================================================================================

================================================================================
Date: 2026-02-06 11:30:33.177617
Fichier: sql/queries/performance.sql
Erreur: Erreur SQL: no such column: total_rec_int
Requête: -- 5. PERFORMANCE PAR DURÉE DE PRÊT
SELECT 
    term as duree,
    COUNT(*) as nombre_prets,
    ROUND(SUM(loan_amnt), 0) as montant_emis,
    ROUND(SUM(total_pymnt), 0) as paiements_recus,
    ROUND(... (tronquée)
================================================================================

================================================================================
Date: 2026-02-06 11:30:33.177836
Fichier: sql/queries/performance.sql
Erreur: Erreur SQL: no such column: recoveries
Requête: -- 6. RECOUVREMENT DES PRÊTS EN DÉFAUT
SELECT 
    grade,
    COUNT(*) as nombre_defauts,
    ROUND(SUM(loan_amnt), 0) as montant_defaut,
    ROUND(SUM(recoveries), 0) as montant_recupere,
    ROUND(S... (tronquée)
================================================================================

================================================================================
Date: 2026-02-06 11:30:33.178057
Fichier: sql/queries/performance.sql
Erreur: Erreur SQL: RIGHT and FULL OUTER JOINs are not currently supported
Requête: -- 7. FLUX DE TRÉSORERIE MENSUEL
WITH paiements_mensuels AS (
    SELECT 
        STRFTIME('%Y-%m', last_pymnt_d) as mois_paiement,
        COUNT(*) as nombre_paiements,
        ROUND(SUM(last_pymnt_a... (tronquée)
================================================================================

================================================================================
Date: 2026-02-06 11:30:33.178282
Fichier: sql/queries/performance.sql
Erreur: Erreur SQL: no such column: last_pymnt_d
Requête: -- 8. ANALYSE DE LA DURÉE EFFECTIVE DES PRÊTS
SELECT 
    CASE 
        WHEN term LIKE '%36%' THEN '36 mois'
        WHEN term LIKE '%60%' THEN '60 mois'
        ELSE 'Autre'
    END as duree_contract... (tronquée)
================================================================================

================================================================================
Date: 2026-02-06 11:30:33.178501
Fichier: sql/queries/performance.sql
Erreur: Erreur SQL: no such column: income_category
Requête: -- 9. PERFORMANCE PAR CATÉGORIE DE REVENU
SELECT 
    income_category as categorie_revenu,
    COUNT(*) as nombre_prets,
    ROUND(SUM(loan_amnt), 0) as montant_emis,
    ROUND(SUM(total_pymnt), 0) as... (tronquée)
================================================================================

================================================================================
Date: 2026-02-06 11:30:33.178709
Fichier: sql/queries/performance.sql
Erreur: Erreur SQL: no such column: int_rate_category
Requête: -- 10. RENDEMENT PAR TAUX D'INTÉRÊT
SELECT 
    int_rate_category as tranche_taux,
    COUNT(*) as nombre_prets,
    ROUND(SUM(loan_amnt), 0) as montant_emis,
    ROUND(SUM(total_pymnt), 0) as paiemen... (tronquée)
================================================================================

================================================================================
Date: 2026-02-06 11:30:33.178920
Fichier: sql/queries/performance.sql
Erreur: Erreur SQL: no such column: last_pymnt_d
Requête: -- 11. ANALYSE DES PRÊTS REMBOURSÉS ANTICIPÉMENT
SELECT 
    CASE 
        WHEN last_pymnt_d IS NOT NULL AND issue_d IS NOT NULL 
        THEN 
            CASE 
                WHEN term LIKE '%36%' ... (tronquée)
================================================================================

================================================================================
Date: 2026-02-06 11:30:33.179157
Fichier: sql/queries/performance.sql
Erreur: Erreur SQL: no such column: last_pymnt_amnt
Requête: -- 12. TABLEAU DE BORD PERFORMANCE (VUE SYNTHÈSE)
SELECT 
    'Rentabilité' as categorie,
    'Marge brute' as indicateur,
    ROUND((SUM(total_pymnt) - SUM(loan_amnt)) * 100.0 / SUM(loan_amnt), 2) as... (tronquée)
================================================================================

================================================================================
Date: 2026-02-06 11:30:33.179592
Fichier: sql/queries/risk_analysis.sql
Erreur: Erreur SQL: no such column: sub_grade
Requête: -- =============================================================================
-- ANALYSE DES RISQUES DU PORTEFEUILLE
-- =============================================================================... (tronquée)
================================================================================

================================================================================
Date: 2026-02-06 11:34:20.448105
Fichier: sql/queries/risk_analysis.sql
Erreur: Erreur SQL: database or disk is full
Requête: -- 3. ANALYSE DE LA CORRÉLATION MONTANT/TAUX DE DÉFAUT
WITH montant_tranches AS (
    SELECT 
        loan_amnt,
        CASE 
            WHEN loan_amnt <= 5000 THEN '0-5k'
            WHEN loan_amnt... (tronquée)
================================================================================

================================================================================
Date: 2026-02-06 11:34:21.266126
Fichier: sql/queries/risk_analysis.sql
Erreur: Erreur SQL: no such column: verification_status
Requête: -- 5. DÉFAUT PAR STATUT DE VÉRIFICATION DE REVENU
SELECT 
    verification_status as statut_verification,
    COUNT(*) as nombre_prets,
    ROUND(SUM(loan_amnt), 0) as montant_total,
    ROUND(AVG(int... (tronquée)
================================================================================

================================================================================
Date: 2026-02-06 11:34:21.266758
Fichier: sql/queries/risk_analysis.sql
Erreur: Erreur SQL: no such column: credit_age_category
Requête: -- 6. ANALYSE DE RISQUE PAR ÂGE DU CRÉDIT
SELECT 
    credit_age_category as categorie_age_credit,
    COUNT(*) as nombre_prets,
    ROUND(SUM(loan_amnt), 0) as montant_total,
    ROUND(AVG(int_rate),... (tronquée)
================================================================================

================================================================================
Date: 2026-02-06 11:34:21.267316
Fichier: sql/queries/risk_analysis.sql
Erreur: Erreur SQL: no such column: id
Requête: -- 7. PRÊTS À HAUT RISQUE (MULTIPLE CRITÈRES)
SELECT 
    id,
    loan_amnt,
    int_rate,
    grade,
    sub_grade,
    term,
    home_ownership,
    annual_inc,
    dti,
    loan_status,
    credit_... (tronquée)
================================================================================

================================================================================
Date: 2026-02-06 11:34:21.267622
Fichier: sql/queries/risk_analysis.sql
Erreur: Erreur SQL: no such column: income_category
Requête: -- 8. IMPACT DU REVENU SUR LES DÉFAUTS
SELECT 
    income_category as categorie_revenu,
    COUNT(*) as nombre_prets,
    ROUND(SUM(loan_amnt), 0) as montant_total,
    ROUND(AVG(int_rate), 2) as taux... (tronquée)
================================================================================

================================================================================
Date: 2026-02-06 11:34:22.612357
Fichier: sql/queries/risk_analysis.sql
Erreur: Erreur SQL: no such column: revol_bal
Requête: -- 10. RISQUE PAR UTILISATION DU CRÉDIT REVOLVING
SELECT 
    CASE 
        WHEN revol_util IS NULL THEN 'Non renseigné'
        WHEN revol_util <= 20 THEN '0-20%'
        WHEN revol_util <= 40 THEN '... (tronquée)
================================================================================

================================================================================
Date: 2026-02-06 11:34:25.105320
Fichier: sql/queries/segmentation.sql
Erreur: Erreur SQL: no such column: emp_title
Requête: -- =============================================================================
-- SEGMENTATION DES EMPRUNTEURS
-- =============================================================================

-- 1.... (tronquée)
================================================================================

================================================================================
Date: 2026-02-06 11:34:29.321214
Fichier: sql/queries/segmentation.sql
Erreur: Erreur SQL: no such column: credit_age_category
Requête: -- 6. SEGMENTATION PAR ÂGE DU CRÉDIT
SELECT 
    credit_age_category as categorie_age_credit,
    COUNT(*) as nombre_emprunteurs,
    ROUND(COUNT(*) * 100.0 / (SELECT COUNT(*) FROM loans), 2) as pourc... (tronquée)
================================================================================

================================================================================
Date: 2026-02-06 11:34:29.321463
Fichier: sql/queries/segmentation.sql
Erreur: Erreur SQL: no such column: pub_rec
Requête: -- 7. PROFIL DE CRÉDIT (HISTORIQUE)
SELECT 
    CASE 
        WHEN delinq_2yrs = 0 AND pub_rec = 0 THEN 'Historique propre'
        WHEN delinq_2yrs > 0 AND pub_rec = 0 THEN 'Délinquances mineures'
  ... (tronquée)
================================================================================

================================================================================
Date: 2026-02-06 11:34:29.321695
Fichier: sql/queries/segmentation.sql
Erreur: Erreur SQL: no such column: credit_age_years
Requête: -- 8. SEGMENTATION PAR TYPE DE PROPRIÉTÉ
SELECT 
    home_ownership as type_propriete,
    COUNT(*) as nombre_emprunteurs,
    ROUND(COUNT(*) * 100.0 / (SELECT COUNT(*) FROM loans), 2) as pourcentage_... (tronquée)
================================================================================

================================================================================
Date: 2026-02-06 11:34:29.321914
Fichier: sql/queries/segmentation.sql
Erreur: Erreur SQL: no such column: inq_last_6mths
Requête: -- 9. COMPORTEMENT DE RECHERCHE DE CRÉDIT
SELECT 
    CASE 
        WHEN inq_last_6mths = 0 THEN '0 requête'
        WHEN inq_last_6mths = 1 THEN '1 requête'
        WHEN inq_last_6mths = 2 THEN '2 re... (tronquée)
================================================================================

================================================================================
Date: 2026-02-06 11:34:29.322094
Fichier: sql/queries/segmentation.sql
Erreur: Erreur SQL: no such column: open_acc
Requête: -- 10. SEGMENTATION PAR NOMBRE DE COMPTES OUVERTS
SELECT 
    CASE 
        WHEN open_acc <= 5 THEN '0-5 comptes'
        WHEN open_acc <= 10 THEN '6-10 comptes'
        WHEN open_acc <= 15 THEN '11-1... (tronquée)
================================================================================

================================================================================
Date: 2026-02-06 11:34:29.322343
Fichier: sql/queries/segmentation.sql
Erreur: Erreur SQL: no such column: id
Requête: -- 11. PROFILS COMPLEXES (CROISEMENT MULTI-CRITÈRES)
WITH profils AS (
    SELECT 
        id,
        CASE 
            WHEN annual_inc >= 100000 AND dti <= 20 AND grade IN ('A', 'B') THEN 'Premium'
... (tronquée)
================================================================================

================================================================================
Date: 2026-02-06 11:34:29.322547
Fichier: sql/queries/segmentation.sql
Erreur: Erreur SQL: no such column: income_category
Requête: -- 12. MATRICE DE SEGMENTATION FINALE POUR MARKETING
SELECT 
    income_category as segment_revenu,
    risk_category as segment_risque,
    COUNT(*) as nombre_clients,
    ROUND(COUNT(*) * 100.0 / (S... (tronquée)
================================================================================

================================================================================
Date: 2026-02-06 12:08:50.982212
Fichier: sql/queries/kpi_overview.sql
Erreur: Erreur SQL: 1st ORDER BY term does not match any column in the result set
Requête: -- =============================================================================
-- REQUÊTES SQL POUR LES KPIs DE VUE D'ENSEMBLE
-- ====================================================================... (tronquée)
================================================================================

================================================================================
Date: 2026-02-06 12:08:53.532501
Fichier: sql/queries/kpi_overview.sql
Erreur: Erreur SQL: no such column: issue_year
Requête: -- 6. ÉVOLUTION TEMPORELLE DES DÉCAISSEMENTS
SELECT 
    issue_year as annee,
    issue_month as mois,
    issue_year || '-' || PRINTF('%02d', issue_month) as periode,
    COUNT(*) as prets_emis,
    ... (tronquée)
================================================================================

================================================================================
Date: 2026-02-06 12:08:53.532750
Fichier: sql/queries/kpi_overview.sql
Erreur: Erreur SQL: no such column: issue_year
Requête: -- 7. PERFORMANCE PAR ANNÉE
SELECT 
    issue_year as annee,
    COUNT(*) as total_prets,
    ROUND(SUM(loan_amnt), 0) as montant_total,
    ROUND(AVG(int_rate), 2) as taux_interet_moyen,
    SUM(CASE... (tronquée)
================================================================================

================================================================================
Date: 2026-02-06 12:08:53.993333
Fichier: sql/queries/kpi_overview.sql
Erreur: Erreur SQL: no such column: issue_season
Requête: -- 9. RÉCAPITULATIF PAR SAISON
SELECT 
    issue_season as saison,
    COUNT(*) as nombre_prets,
    ROUND(COUNT(*) * 100.0 / (SELECT COUNT(*) FROM loans), 2) as pourcentage_total,
    ROUND(SUM(loan_... (tronquée)
================================================================================

================================================================================
Date: 2026-02-06 12:08:54.837343
Fichier: sql/queries/performance.sql
Erreur: Erreur SQL: no such column: total_rec_prncp
Requête: -- =============================================================================
-- ANALYSE DE PERFORMANCE ET RECOUVREMENT
-- ==========================================================================... (tronquée)
================================================================================

================================================================================
Date: 2026-02-06 12:08:54.837755
Fichier: sql/queries/performance.sql
Erreur: Erreur SQL: no such column: total_rec_int
Requête: -- 2. PERFORMANCE PAR GRADE - ANALYSE DE RENTABILITÉ
SELECT 
    grade,
    COUNT(*) as nombre_prets,
    ROUND(SUM(loan_amnt), 0) as montant_total,
    ROUND(SUM(total_pymnt), 0) as paiements_recus,
... (tronquée)
================================================================================

================================================================================
Date: 2026-02-06 12:08:54.838027
Fichier: sql/queries/performance.sql
Erreur: Erreur SQL: no such column: issue_year
Requête: -- 3. ÉVOLUTION TEMPORELLE DES PERFORMANCES
SELECT 
    issue_year as annee,
    issue_quarter as trimestre,
    issue_year || 'T' || issue_quarter as periode,
    COUNT(*) as prets_emis,
    ROUND(SU... (tronquée)
================================================================================

================================================================================
Date: 2026-02-06 12:08:54.838274
Fichier: sql/queries/performance.sql
Erreur: Erreur SQL: no such column: out_prncp
Requête: -- 4. ANALYSE DES PAIEMENTS EN RETARD
SELECT 
    CASE 
        WHEN loan_status LIKE 'LATE%' THEN 'En retard'
        WHEN loan_status = 'IN GRACE PERIOD' THEN 'Période de grâce'
        ELSE 'À jour... (tronquée)
================================================================================

================================================================================
Date: 2026-02-06 12:08:54.838569
Fichier: sql/queries/performance.sql
Erreur: Erreur SQL: no such column: total_rec_int
Requête: -- 5. PERFORMANCE PAR DURÉE DE PRÊT
SELECT 
    term as duree,
    COUNT(*) as nombre_prets,
    ROUND(SUM(loan_amnt), 0) as montant_emis,
    ROUND(SUM(total_pymnt), 0) as paiements_recus,
    ROUND(... (tronquée)
================================================================================

================================================================================
Date: 2026-02-06 12:08:54.838856
Fichier: sql/queries/performance.sql
Erreur: Erreur SQL: no such column: recoveries
Requête: -- 6. RECOUVREMENT DES PRÊTS EN DÉFAUT
SELECT 
    grade,
    COUNT(*) as nombre_defauts,
    ROUND(SUM(loan_amnt), 0) as montant_defaut,
    ROUND(SUM(recoveries), 0) as montant_recupere,
    ROUND(S... (tronquée)
================================================================================

================================================================================
Date: 2026-02-06 12:08:54.839151
Fichier: sql/queries/performance.sql
Erreur: Erreur SQL: RIGHT and FULL OUTER JOINs are not currently supported
Requête: -- 7. FLUX DE TRÉSORERIE MENSUEL
WITH paiements_mensuels AS (
    SELECT 
        STRFTIME('%Y-%m', last_pymnt_d) as mois_paiement,
        COUNT(*) as nombre_paiements,
        ROUND(SUM(last_pymnt_a... (tronquée)
================================================================================

================================================================================
Date: 2026-02-06 12:08:54.839416
Fichier: sql/queries/performance.sql
Erreur: Erreur SQL: no such column: last_pymnt_d
Requête: -- 8. ANALYSE DE LA DURÉE EFFECTIVE DES PRÊTS
SELECT 
    CASE 
        WHEN term LIKE '%36%' THEN '36 mois'
        WHEN term LIKE '%60%' THEN '60 mois'
        ELSE 'Autre'
    END as duree_contract... (tronquée)
================================================================================

================================================================================
Date: 2026-02-06 12:08:54.839731
Fichier: sql/queries/performance.sql
Erreur: Erreur SQL: no such column: income_category
Requête: -- 9. PERFORMANCE PAR CATÉGORIE DE REVENU
SELECT 
    income_category as categorie_revenu,
    COUNT(*) as nombre_prets,
    ROUND(SUM(loan_amnt), 0) as montant_emis,
    ROUND(SUM(total_pymnt), 0) as... (tronquée)
================================================================================

================================================================================
Date: 2026-02-06 12:08:54.839976
Fichier: sql/queries/performance.sql
Erreur: Erreur SQL: no such column: int_rate_category
Requête: -- 10. RENDEMENT PAR TAUX D'INTÉRÊT
SELECT 
    int_rate_category as tranche_taux,
    COUNT(*) as nombre_prets,
    ROUND(SUM(loan_amnt), 0) as montant_emis,
    ROUND(SUM(total_pymnt), 0) as paiemen... (tronquée)
================================================================================

================================================================================
Date: 2026-02-06 12:08:54.840215
Fichier: sql/queries/performance.sql
Erreur: Erreur SQL: no such column: last_pymnt_d
Requête: -- 11. ANALYSE DES PRÊTS REMBOURSÉS ANTICIPÉMENT
SELECT 
    CASE 
        WHEN last_pymnt_d IS NOT NULL AND issue_d IS NOT NULL 
        THEN 
            CASE 
                WHEN term LIKE '%36%' ... (tronquée)
================================================================================

================================================================================
Date: 2026-02-06 12:08:54.840494
Fichier: sql/queries/performance.sql
Erreur: Erreur SQL: no such column: last_pymnt_amnt
Requête: -- 12. TABLEAU DE BORD PERFORMANCE (VUE SYNTHÈSE)
SELECT 
    'Rentabilité' as categorie,
    'Marge brute' as indicateur,
    ROUND((SUM(total_pymnt) - SUM(loan_amnt)) * 100.0 / SUM(loan_amnt), 2) as... (tronquée)
================================================================================

================================================================================
Date: 2026-02-06 12:08:54.841053
Fichier: sql/queries/risk_analysis.sql
Erreur: Erreur SQL: no such column: sub_grade
Requête: -- =============================================================================
-- ANALYSE DES RISQUES DU PORTEFEUILLE
-- =============================================================================... (tronquée)
================================================================================

================================================================================
Date: 2026-02-06 12:14:06.703922
Fichier: sql/queries/risk_analysis.sql
Erreur: Erreur SQL: database or disk is full
Requête: -- 3. ANALYSE DE LA CORRÉLATION MONTANT/TAUX DE DÉFAUT
WITH montant_tranches AS (
    SELECT 
        loan_amnt,
        CASE 
            WHEN loan_amnt <= 5000 THEN '0-5k'
            WHEN loan_amnt... (tronquée)
================================================================================

================================================================================
Date: 2026-02-06 12:14:07.542356
Fichier: sql/queries/risk_analysis.sql
Erreur: Erreur SQL: no such column: verification_status
Requête: -- 5. DÉFAUT PAR STATUT DE VÉRIFICATION DE REVENU
SELECT 
    verification_status as statut_verification,
    COUNT(*) as nombre_prets,
    ROUND(SUM(loan_amnt), 0) as montant_total,
    ROUND(AVG(int... (tronquée)
================================================================================

================================================================================
Date: 2026-02-06 12:14:07.542663
Fichier: sql/queries/risk_analysis.sql
Erreur: Erreur SQL: no such column: credit_age_category
Requête: -- 6. ANALYSE DE RISQUE PAR ÂGE DU CRÉDIT
SELECT 
    credit_age_category as categorie_age_credit,
    COUNT(*) as nombre_prets,
    ROUND(SUM(loan_amnt), 0) as montant_total,
    ROUND(AVG(int_rate),... (tronquée)
================================================================================

================================================================================
Date: 2026-02-06 12:14:07.542928
Fichier: sql/queries/risk_analysis.sql
Erreur: Erreur SQL: no such column: id
Requête: -- 7. PRÊTS À HAUT RISQUE (MULTIPLE CRITÈRES)
SELECT 
    id,
    loan_amnt,
    int_rate,
    grade,
    sub_grade,
    term,
    home_ownership,
    annual_inc,
    dti,
    loan_status,
    credit_... (tronquée)
================================================================================

================================================================================
Date: 2026-02-06 12:14:07.543152
Fichier: sql/queries/risk_analysis.sql
Erreur: Erreur SQL: no such column: income_category
Requête: -- 8. IMPACT DU REVENU SUR LES DÉFAUTS
SELECT 
    income_category as categorie_revenu,
    COUNT(*) as nombre_prets,
    ROUND(SUM(loan_amnt), 0) as montant_total,
    ROUND(AVG(int_rate), 2) as taux... (tronquée)
================================================================================

================================================================================
Date: 2026-02-06 12:14:08.368834
Fichier: sql/queries/risk_analysis.sql
Erreur: Erreur SQL: no such column: revol_bal
Requête: -- 10. RISQUE PAR UTILISATION DU CRÉDIT REVOLVING
SELECT 
    CASE 
        WHEN revol_util IS NULL THEN 'Non renseigné'
        WHEN revol_util <= 20 THEN '0-20%'
        WHEN revol_util <= 40 THEN '... (tronquée)
================================================================================

================================================================================
Date: 2026-02-06 12:14:09.934244
Fichier: sql/queries/segmentation.sql
Erreur: Erreur SQL: no such column: emp_title
Requête: -- =============================================================================
-- SEGMENTATION DES EMPRUNTEURS
-- =============================================================================

-- 1.... (tronquée)
================================================================================

================================================================================
Date: 2026-02-06 12:14:14.416823
Fichier: sql/queries/segmentation.sql
Erreur: Erreur SQL: no such column: credit_age_category
Requête: -- 6. SEGMENTATION PAR ÂGE DU CRÉDIT
SELECT 
    credit_age_category as categorie_age_credit,
    COUNT(*) as nombre_emprunteurs,
    ROUND(COUNT(*) * 100.0 / (SELECT COUNT(*) FROM loans), 2) as pourc... (tronquée)
================================================================================

================================================================================
Date: 2026-02-06 12:14:14.417203
Fichier: sql/queries/segmentation.sql
Erreur: Erreur SQL: no such column: pub_rec
Requête: -- 7. PROFIL DE CRÉDIT (HISTORIQUE)
SELECT 
    CASE 
        WHEN delinq_2yrs = 0 AND pub_rec = 0 THEN 'Historique propre'
        WHEN delinq_2yrs > 0 AND pub_rec = 0 THEN 'Délinquances mineures'
  ... (tronquée)
================================================================================

================================================================================
Date: 2026-02-06 12:14:14.417481
Fichier: sql/queries/segmentation.sql
Erreur: Erreur SQL: no such column: credit_age_years
Requête: -- 8. SEGMENTATION PAR TYPE DE PROPRIÉTÉ
SELECT 
    home_ownership as type_propriete,
    COUNT(*) as nombre_emprunteurs,
    ROUND(COUNT(*) * 100.0 / (SELECT COUNT(*) FROM loans), 2) as pourcentage_... (tronquée)
================================================================================

================================================================================
Date: 2026-02-06 12:14:14.417776
Fichier: sql/queries/segmentation.sql
Erreur: Erreur SQL: no such column: inq_last_6mths
Requête: -- 9. COMPORTEMENT DE RECHERCHE DE CRÉDIT
SELECT 
    CASE 
        WHEN inq_last_6mths = 0 THEN '0 requête'
        WHEN inq_last_6mths = 1 THEN '1 requête'
        WHEN inq_last_6mths = 2 THEN '2 re... (tronquée)
================================================================================

================================================================================
Date: 2026-02-06 12:14:14.418025
Fichier: sql/queries/segmentation.sql
Erreur: Erreur SQL: no such column: open_acc
Requête: -- 10. SEGMENTATION PAR NOMBRE DE COMPTES OUVERTS
SELECT 
    CASE 
        WHEN open_acc <= 5 THEN '0-5 comptes'
        WHEN open_acc <= 10 THEN '6-10 comptes'
        WHEN open_acc <= 15 THEN '11-1... (tronquée)
================================================================================

================================================================================
Date: 2026-02-06 12:14:14.418417
Fichier: sql/queries/segmentation.sql
Erreur: Erreur SQL: no such column: id
Requête: -- 11. PROFILS COMPLEXES (CROISEMENT MULTI-CRITÈRES)
WITH profils AS (
    SELECT 
        id,
        CASE 
            WHEN annual_inc >= 100000 AND dti <= 20 AND grade IN ('A', 'B') THEN 'Premium'
... (tronquée)
================================================================================

================================================================================
Date: 2026-02-06 12:14:14.418753
Fichier: sql/queries/segmentation.sql
Erreur: Erreur SQL: no such column: income_category
Requête: -- 12. MATRICE DE SEGMENTATION FINALE POUR MARKETING
SELECT 
    income_category as segment_revenu,
    risk_category as segment_risque,
    COUNT(*) as nombre_clients,
    ROUND(COUNT(*) * 100.0 / (S... (tronquée)
================================================================================

================================================================================
Date: 2026-02-06 12:58:16.513213
Fichier: sql/queries/kpi_overview.sql
Erreur: Erreur SQL: 1st ORDER BY term does not match any column in the result set
Requête: -- =============================================================================
-- REQUÊTES SQL POUR LES KPIs DE VUE D'ENSEMBLE
-- ====================================================================... (tronquée)
================================================================================

================================================================================
Date: 2026-02-06 12:58:18.811192
Fichier: sql/queries/kpi_overview.sql
Erreur: Erreur SQL: no such column: issue_year
Requête: -- 6. ÉVOLUTION TEMPORELLE DES DÉCAISSEMENTS
SELECT 
    issue_year as annee,
    issue_month as mois,
    issue_year || '-' || PRINTF('%02d', issue_month) as periode,
    COUNT(*) as prets_emis,
    ... (tronquée)
================================================================================

================================================================================
Date: 2026-02-06 12:58:18.811456
Fichier: sql/queries/kpi_overview.sql
Erreur: Erreur SQL: no such column: issue_year
Requête: -- 7. PERFORMANCE PAR ANNÉE
SELECT 
    issue_year as annee,
    COUNT(*) as total_prets,
    ROUND(SUM(loan_amnt), 0) as montant_total,
    ROUND(AVG(int_rate), 2) as taux_interet_moyen,
    SUM(CASE... (tronquée)
================================================================================

================================================================================
Date: 2026-02-06 12:58:19.241949
Fichier: sql/queries/kpi_overview.sql
Erreur: Erreur SQL: no such column: issue_season
Requête: -- 9. RÉCAPITULATIF PAR SAISON
SELECT 
    issue_season as saison,
    COUNT(*) as nombre_prets,
    ROUND(COUNT(*) * 100.0 / (SELECT COUNT(*) FROM loans), 2) as pourcentage_total,
    ROUND(SUM(loan_... (tronquée)
================================================================================

================================================================================
Date: 2026-02-06 12:58:20.125571
Fichier: sql/queries/performance.sql
Erreur: Erreur SQL: no such column: total_rec_prncp
Requête: -- =============================================================================
-- ANALYSE DE PERFORMANCE ET RECOUVREMENT
-- ==========================================================================... (tronquée)
================================================================================

================================================================================
Date: 2026-02-06 12:58:20.125905
Fichier: sql/queries/performance.sql
Erreur: Erreur SQL: no such column: total_rec_int
Requête: -- 2. PERFORMANCE PAR GRADE - ANALYSE DE RENTABILITÉ
SELECT 
    grade,
    COUNT(*) as nombre_prets,
    ROUND(SUM(loan_amnt), 0) as montant_total,
    ROUND(SUM(total_pymnt), 0) as paiements_recus,
... (tronquée)
================================================================================

================================================================================
Date: 2026-02-06 12:58:20.126201
Fichier: sql/queries/performance.sql
Erreur: Erreur SQL: no such column: issue_year
Requête: -- 3. ÉVOLUTION TEMPORELLE DES PERFORMANCES
SELECT 
    issue_year as annee,
    issue_quarter as trimestre,
    issue_year || 'T' || issue_quarter as periode,
    COUNT(*) as prets_emis,
    ROUND(SU... (tronquée)
================================================================================

================================================================================
Date: 2026-02-06 12:58:20.126478
Fichier: sql/queries/performance.sql
Erreur: Erreur SQL: no such column: out_prncp
Requête: -- 4. ANALYSE DES PAIEMENTS EN RETARD
SELECT 
    CASE 
        WHEN loan_status LIKE 'LATE%' THEN 'En retard'
        WHEN loan_status = 'IN GRACE PERIOD' THEN 'Période de grâce'
        ELSE 'À jour... (tronquée)
================================================================================

================================================================================
Date: 2026-02-06 12:58:20.126753
Fichier: sql/queries/performance.sql
Erreur: Erreur SQL: no such column: total_rec_int
Requête: -- 5. PERFORMANCE PAR DURÉE DE PRÊT
SELECT 
    term as duree,
    COUNT(*) as nombre_prets,
    ROUND(SUM(loan_amnt), 0) as montant_emis,
    ROUND(SUM(total_pymnt), 0) as paiements_recus,
    ROUND(... (tronquée)
================================================================================

================================================================================
Date: 2026-02-06 12:58:20.127006
Fichier: sql/queries/performance.sql
Erreur: Erreur SQL: no such column: recoveries
Requête: -- 6. RECOUVREMENT DES PRÊTS EN DÉFAUT
SELECT 
    grade,
    COUNT(*) as nombre_defauts,
    ROUND(SUM(loan_amnt), 0) as montant_defaut,
    ROUND(SUM(recoveries), 0) as montant_recupere,
    ROUND(S... (tronquée)
================================================================================

================================================================================
Date: 2026-02-06 12:58:20.127311
Fichier: sql/queries/performance.sql
Erreur: Erreur SQL: RIGHT and FULL OUTER JOINs are not currently supported
Requête: -- 7. FLUX DE TRÉSORERIE MENSUEL
WITH paiements_mensuels AS (
    SELECT 
        STRFTIME('%Y-%m', last_pymnt_d) as mois_paiement,
        COUNT(*) as nombre_paiements,
        ROUND(SUM(last_pymnt_a... (tronquée)
================================================================================

================================================================================
Date: 2026-02-06 12:58:20.127622
Fichier: sql/queries/performance.sql
Erreur: Erreur SQL: no such column: last_pymnt_d
Requête: -- 8. ANALYSE DE LA DURÉE EFFECTIVE DES PRÊTS
SELECT 
    CASE 
        WHEN term LIKE '%36%' THEN '36 mois'
        WHEN term LIKE '%60%' THEN '60 mois'
        ELSE 'Autre'
    END as duree_contract... (tronquée)
================================================================================

================================================================================
Date: 2026-02-06 12:58:20.127923
Fichier: sql/queries/performance.sql
Erreur: Erreur SQL: no such column: income_category
Requête: -- 9. PERFORMANCE PAR CATÉGORIE DE REVENU
SELECT 
    income_category as categorie_revenu,
    COUNT(*) as nombre_prets,
    ROUND(SUM(loan_amnt), 0) as montant_emis,
    ROUND(SUM(total_pymnt), 0) as... (tronquée)
================================================================================

================================================================================
Date: 2026-02-06 12:58:20.128213
Fichier: sql/queries/performance.sql
Erreur: Erreur SQL: no such column: int_rate_category
Requête: -- 10. RENDEMENT PAR TAUX D'INTÉRÊT
SELECT 
    int_rate_category as tranche_taux,
    COUNT(*) as nombre_prets,
    ROUND(SUM(loan_amnt), 0) as montant_emis,
    ROUND(SUM(total_pymnt), 0) as paiemen... (tronquée)
================================================================================

================================================================================
Date: 2026-02-06 12:58:20.128513
Fichier: sql/queries/performance.sql
Erreur: Erreur SQL: no such column: last_pymnt_d
Requête: -- 11. ANALYSE DES PRÊTS REMBOURSÉS ANTICIPÉMENT
SELECT 
    CASE 
        WHEN last_pymnt_d IS NOT NULL AND issue_d IS NOT NULL 
        THEN 
            CASE 
                WHEN term LIKE '%36%' ... (tronquée)
================================================================================

================================================================================
Date: 2026-02-06 12:58:20.128851
Fichier: sql/queries/performance.sql
Erreur: Erreur SQL: no such column: last_pymnt_amnt
Requête: -- 12. TABLEAU DE BORD PERFORMANCE (VUE SYNTHÈSE)
SELECT 
    'Rentabilité' as categorie,
    'Marge brute' as indicateur,
    ROUND((SUM(total_pymnt) - SUM(loan_amnt)) * 100.0 / SUM(loan_amnt), 2) as... (tronquée)
================================================================================

================================================================================
Date: 2026-02-06 13:05:42.410792
Fichier: sql/queries/risk_analysis.sql
Erreur: Erreur SQL: database or disk is full
Requête: -- 3. ANALYSE DE LA CORRÉLATION MONTANT/TAUX DE DÉFAUT
WITH montant_tranches AS (
    SELECT 
        loan_amnt,
        CASE 
            WHEN loan_amnt <= 5000 THEN '0-5k'
            WHEN loan_amnt... (tronquée)
================================================================================

================================================================================
Date: 2026-02-06 13:05:43.209384
Fichier: sql/queries/risk_analysis.sql
Erreur: Erreur SQL: no such column: verification_status
Requête: -- 5. DÉFAUT PAR STATUT DE VÉRIFICATION DE REVENU
SELECT 
    verification_status as statut_verification,
    COUNT(*) as nombre_prets,
    ROUND(SUM(loan_amnt), 0) as montant_total,
    ROUND(AVG(int... (tronquée)
================================================================================

================================================================================
Date: 2026-02-06 13:05:43.209725
Fichier: sql/queries/risk_analysis.sql
Erreur: Erreur SQL: no such column: credit_age_category
Requête: -- 6. ANALYSE DE RISQUE PAR ÂGE DU CRÉDIT
SELECT 
    credit_age_category as categorie_age_credit,
    COUNT(*) as nombre_prets,
    ROUND(SUM(loan_amnt), 0) as montant_total,
    ROUND(AVG(int_rate),... (tronquée)
================================================================================

================================================================================
Date: 2026-02-06 13:05:43.209972
Fichier: sql/queries/risk_analysis.sql
Erreur: Erreur SQL: no such column: id
Requête: -- 7. PRÊTS À HAUT RISQUE (MULTIPLE CRITÈRES)
SELECT 
    id,
    loan_amnt,
    int_rate,
    grade,
    
    term,
    home_ownership,
    annual_inc,
    dti,
    loan_status,
    credit_age_years,... (tronquée)
================================================================================

================================================================================
Date: 2026-02-06 13:05:43.210216
Fichier: sql/queries/risk_analysis.sql
Erreur: Erreur SQL: no such column: income_category
Requête: -- 8. IMPACT DU REVENU SUR LES DÉFAUTS
SELECT 
    income_category as categorie_revenu,
    COUNT(*) as nombre_prets,
    ROUND(SUM(loan_amnt), 0) as montant_total,
    ROUND(AVG(int_rate), 2) as taux... (tronquée)
================================================================================

================================================================================
Date: 2026-02-06 13:05:44.983324
Fichier: sql/queries/risk_analysis.sql
Erreur: Erreur SQL: no such column: revol_bal
Requête: -- 10. RISQUE PAR UTILISATION DU CRÉDIT REVOLVING
SELECT 
    CASE 
        WHEN revol_util IS NULL THEN 'Non renseigné'
        WHEN revol_util <= 20 THEN '0-20%'
        WHEN revol_util <= 40 THEN '... (tronquée)
================================================================================

================================================================================
Date: 2026-02-06 13:05:46.588190
Fichier: sql/queries/segmentation.sql
Erreur: Erreur SQL: no such column: emp_title
Requête: -- =============================================================================
-- SEGMENTATION DES EMPRUNTEURS
-- =============================================================================

-- 1.... (tronquée)
================================================================================

================================================================================
Date: 2026-02-06 13:05:51.255968
Fichier: sql/queries/segmentation.sql
Erreur: Erreur SQL: no such column: credit_age_category
Requête: -- 6. SEGMENTATION PAR ÂGE DU CRÉDIT
SELECT 
    credit_age_category as categorie_age_credit,
    COUNT(*) as nombre_emprunteurs,
    ROUND(COUNT(*) * 100.0 / (SELECT COUNT(*) FROM loans), 2) as pourc... (tronquée)
================================================================================

================================================================================
Date: 2026-02-06 13:05:51.256319
Fichier: sql/queries/segmentation.sql
Erreur: Erreur SQL: no such column: pub_rec
Requête: -- 7. PROFIL DE CRÉDIT (HISTORIQUE)
SELECT 
    CASE 
        WHEN delinq_2yrs = 0 AND pub_rec = 0 THEN 'Historique propre'
        WHEN delinq_2yrs > 0 AND pub_rec = 0 THEN 'Délinquances mineures'
  ... (tronquée)
================================================================================

================================================================================
Date: 2026-02-06 13:05:51.256590
Fichier: sql/queries/segmentation.sql
Erreur: Erreur SQL: no such column: credit_age_years
Requête: -- 8. SEGMENTATION PAR TYPE DE PROPRIÉTÉ
SELECT 
    home_ownership as type_propriete,
    COUNT(*) as nombre_emprunteurs,
    ROUND(COUNT(*) * 100.0 / (SELECT COUNT(*) FROM loans), 2) as pourcentage_... (tronquée)
================================================================================

================================================================================
Date: 2026-02-06 13:05:51.256828
Fichier: sql/queries/segmentation.sql
Erreur: Erreur SQL: no such column: inq_last_6mths
Requête: -- 9. COMPORTEMENT DE RECHERCHE DE CRÉDIT
SELECT 
    CASE 
        WHEN inq_last_6mths = 0 THEN '0 requête'
        WHEN inq_last_6mths = 1 THEN '1 requête'
        WHEN inq_last_6mths = 2 THEN '2 re... (tronquée)
================================================================================

================================================================================
Date: 2026-02-06 13:05:51.257037
Fichier: sql/queries/segmentation.sql
Erreur: Erreur SQL: no such column: open_acc
Requête: -- 10. SEGMENTATION PAR NOMBRE DE COMPTES OUVERTS
SELECT 
    CASE 
        WHEN open_acc <= 5 THEN '0-5 comptes'
        WHEN open_acc <= 10 THEN '6-10 comptes'
        WHEN open_acc <= 15 THEN '11-1... (tronquée)
================================================================================

================================================================================
Date: 2026-02-06 13:05:51.257404
Fichier: sql/queries/segmentation.sql
Erreur: Erreur SQL: no such column: id
Requête: -- 11. PROFILS COMPLEXES (CROISEMENT MULTI-CRITÈRES)
WITH profils AS (
    SELECT 
        id,
        CASE 
            WHEN annual_inc >= 100000 AND dti <= 20 AND grade IN ('A', 'B') THEN 'Premium'
... (tronquée)
================================================================================

================================================================================
Date: 2026-02-06 13:05:51.257753
Fichier: sql/queries/segmentation.sql
Erreur: Erreur SQL: no such column: income_category
Requête: -- 12. MATRICE DE SEGMENTATION FINALE POUR MARKETING
SELECT 
    income_category as segment_revenu,
    risk_category as segment_risque,
    COUNT(*) as nombre_clients,
    ROUND(COUNT(*) * 100.0 / (S... (tronquée)
================================================================================
